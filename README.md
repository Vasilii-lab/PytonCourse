# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–≥–æ –∏–º–ø–µ–¥–∞–Ω—Å–∞

## üìå –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–º–ø–µ–¥–∞–Ω—Å–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —É—Å–∏–ª–µ–Ω–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã (Surface Wave, SW) –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±—ä—ë–º–Ω–æ–π –≤–æ–ª–Ω—ã (Volume Wave) –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–π —á–∞—Å—Ç–æ—Ç–µ.

## üß† –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–∏
–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É —Ä–∞—Å—á—ë—Ç–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ç—Ä—ë—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (X, A, B), –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π –∏–º–ø–µ–¥–∞–Ω—Å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Å —Ü–µ–ª—å—é –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–æ—â–Ω–æ—Å—Ç–∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã –∫ –º–æ—â–Ω–æ—Å—Ç–∏ –æ–±—ä—ë–º–Ω–æ–π –≤–æ–ª–Ω—ã. –§–∏–∑–∏—á–µ—Å–∫–∏ —ç—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏–º–ø–µ–¥–∞–Ω—Å–Ω—ã—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–µ—Ç–∞–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π –∏–ª–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–º–ø–µ–¥–∞–Ω—Å–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü), –∫–æ—Ç–æ—Ä—ã–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã—Ö –≤–æ–ª–Ω –∏ –ø–æ–¥–∞–≤–ª—è—é—Ç –æ–±—ä—ë–º–Ω–æ–µ –∏–∑–ª—É—á–µ–Ω–∏–µ.

–†–∞—Å—á—ë—Ç –º–æ—â–Ω–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –∏ –æ–±—ä—ë–º–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞:
1. –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è.
2. –ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è –æ—Ç–Ω–æ—à–µ–Ω–∏—è P_surface / P_volume.

## üìê –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–æ—Ä–º—É–ª—ã

### 1. **–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π –∏–º–ø–µ–¥–∞–Ω—Å**
–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π –∏–º–ø–µ–¥–∞–Ω—Å –∑–∞–¥–∞—ë—Ç—Å—è –≤ –≤–∏–¥–µ:

$$
Z_s(\phi) = jX \cdot \frac{1 + A \sin^2(\phi)}{1 + B \sin^2(\phi)}
$$

–≥–¥–µ:
- $X$ ‚Äî —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ (–û–º)
- $A$, $B$ ‚Äî –±–µ–∑—Ä–∞–∑–º–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º—ã
- $\phi$ ‚Äî —É–≥–æ–ª –≤ —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

### 2. **–î–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ**
–£—Å–ª–æ–≤–∏–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã:

$$
\cos^3(\tau) + \frac{jXA}{\eta B} \cos^2(\tau) + \frac{1 - B}{B} \cos(\tau) + \frac{jX(1 - A)}{\eta B} = 0
$$

–≥–¥–µ:
- $\tau = \pi/2 + 1.3j$ ‚Äî –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —É–≥–æ–ª —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è
- $\eta = 120\pi$ ‚Äî –≤–æ–ª–Ω–æ–≤–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

### 3. **–ú–æ—â–Ω–æ—Å—Ç—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã**
–ò–Ω—Ç–µ–≥—Ä–∞–ª –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–µ $z$:

$$
P_{\text{surface}} = \int_0^\infty \frac{1}{2} \Re\{E_{z}^{\text{sw}} \cdot (H_{y}^{\text{sw}})^*\} \, dz
$$

–≥–¥–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–ª—è:

$$
E_{z}^{\text{sw}} = \frac{jI_0 k \eta \cos(\tau) \cdot (1 + B \sin^2(\tau))}{D} \cdot e^{-jkz\cos(\tau)} \cdot e^{-j\Omega\sin(\tau)}
$$

$$
H_{y}^{\text{sw}} = \frac{-2\pi j C \cdot \eta \cos(\tau) \cdot (1 + B \sin^2(\tau))}{\sin(\tau) \cdot D} \cdot e^{-jkz\cos(\tau)} \cdot e^{-j\Omega\sin(\tau)}
$$

$$
D = -2jXA\cos(\tau) - 3B\eta\cos^2(\tau) + \eta(1 + B)
$$

–≥–¥–µ:
- $I_0 = 1.0$ –ê ‚Äî –∞–º–ø–ª–∏—Ç—É–¥–∞ —Ç–æ–∫–∞
- $k = 2\pi/\lambda$ ‚Äî –≤–æ–ª–Ω–æ–≤–æ–µ —á–∏—Å–ª–æ
- $\Omega = kr$ ‚Äî –±–µ–∑—Ä–∞–∑–º–µ—Ä–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
- $C = \dfrac{I_0 k}{2\pi\eta_0}$ ‚Äî –Ω–æ—Ä–º–∏—Ä–æ–≤–æ—á–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞
- $\eta_0 = 377$ –û–º ‚Äî –∏–º–ø–µ–¥–∞–Ω—Å —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

### 4. **–ú–æ—â–Ω–æ—Å—Ç—å –æ–±—ä—ë–º–Ω–æ–π –≤–æ–ª–Ω—ã**
–ò–Ω—Ç–µ–≥—Ä–∞–ª –ø–æ —É–≥–ª—É $\phi$:

$$
P_{\text{volume}} = \int_{-\pi/2}^{\pi/2} \Re\{S_{\text{normal}}\} \, d\phi
$$

–≥–¥–µ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è –≤–µ–∫—Ç–æ—Ä–∞ –ü–æ–π–Ω—Ç–∏–Ω–≥–∞:

$$
S_{\text{normal}} = S_x \sin(\phi) + S_z \cos(\phi)
$$

$$
S_x = -\frac{1}{2} E_z H_y^*, \quad S_z = \frac{1}{2} E_x H_y^*
$$

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–ª—è –¥–ª—è –æ–±—ä—ë–º–Ω–æ–π –≤–æ–ª–Ω—ã:

$$
E_z = -\frac{\eta_0}{\sqrt{\Omega}} A_{\text{amp}} \sin(\phi) e^{-j\Omega}
$$

$$
E_x = \frac{A_{\text{amp}}^e}{\sqrt{\Omega}} e^{-j\Omega}
$$

$$
H_y = \frac{A_{\text{amp}}}{\sqrt{\Omega}} e^{-j\Omega}
$$

—Å –∞–º–ø–ª–∏—Ç—É–¥–∞–º–∏:

$$
A_{\text{amp}} = -\frac{C\sqrt{2\pi}}{e^{-j\pi/4}} \cdot \frac{\cos(\phi)}{(Z_s/\eta_0) + \cos(\phi)}
$$

$$
A_{\text{amp}}^e = \frac{C\sqrt{2\pi}}{e^{-j\pi/4}} \cdot \frac{\cos(\phi) \cdot Z_s}{(Z_s/\eta_0) + \cos(\phi)}
$$

### 5. **–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**
–ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è:

$$
F = -\left[ \log_{10}\left(\frac{P_{\text{surface}}}{P_{\text{volume}}}\right) - \text{surface\_penalty} - \text{ratio\_penalty} \right]
$$

–≥–¥–µ:
- $\text{surface\_penalty}$ ‚Äî —à—Ç—Ä–∞—Ñ –∑–∞ –º–∞–ª—É—é –º–æ—â–Ω–æ—Å—Ç—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã (${\text{P_surface}} < 10^{-9}$ –í—Ç)
- $\text{ratio\_penalty}$ ‚Äî —à—Ç—Ä–∞—Ñ –∑–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–µ–Ω—å—à–µ 1 ($P_{\text{surface}}/{\text{P_volume}} < 1$)

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Å–º. –Ω–∏–∂–µ).
2. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª `optim_v3.py` –≤ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∫–æ–º–∞–Ω–¥–æ–π:
   ```bash
   python optim_v3.py
