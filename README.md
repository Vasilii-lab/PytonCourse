# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–≥–æ –∏–º–ø–µ–¥–∞–Ω—Å–∞

## üìå –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–º–ø–µ–¥–∞–Ω—Å–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —É—Å–∏–ª–µ–Ω–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã (Surface Wave, SW) –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±—ä—ë–º–Ω–æ–π –≤–æ–ª–Ω—ã (Volume Wave) –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–π —á–∞—Å—Ç–æ—Ç–µ.

## üß† –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–∏
–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É —Ä–∞—Å—á—ë—Ç–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ç—Ä—ë—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (X, A, B), –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π –∏–º–ø–µ–¥–∞–Ω—Å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Å —Ü–µ–ª—å—é –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–æ—â–Ω–æ—Å—Ç–∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã –∫ –º–æ—â–Ω–æ—Å—Ç–∏ –æ–±—ä—ë–º–Ω–æ–π –≤–æ–ª–Ω—ã. –§–∏–∑–∏—á–µ—Å–∫–∏ —ç—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏–º–ø–µ–¥–∞–Ω—Å–Ω—ã—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–µ—Ç–∞–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π –∏–ª–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–º–ø–µ–¥–∞–Ω—Å–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü), –∫–æ—Ç–æ—Ä—ã–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã—Ö –≤–æ–ª–Ω –∏ –ø–æ–¥–∞–≤–ª—è—é—Ç –æ–±—ä—ë–º–Ω–æ–µ –∏–∑–ª—É—á–µ–Ω–∏–µ.

–†–∞—Å—á—ë—Ç –º–æ—â–Ω–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –∏ –æ–±—ä—ë–º–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞:
1. –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è.
2. –ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è –æ—Ç–Ω–æ—à–µ–Ω–∏—è P_surface / P_volume.

## üìê –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–æ—Ä–º—É–ª—ã

### 1. **–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π –∏–º–ø–µ–¥–∞–Ω—Å**
–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π –∏–º–ø–µ–¥–∞–Ω—Å –∑–∞–¥–∞—ë—Ç—Å—è –≤ –≤–∏–¥–µ:
Z_s(œÜ) = jX * (1 + A¬∑sin¬≤(œÜ)) / (1 + B¬∑sin¬≤(œÜ))

text
–≥–¥–µ:
- `X` ‚Äî —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ (–û–º)
- `A`, `B` ‚Äî –±–µ–∑—Ä–∞–∑–º–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º—ã
- `œÜ` ‚Äî —É–≥–æ–ª –≤ —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

### 2. **–î–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ**
–£—Å–ª–æ–≤–∏–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã:
cos(œÑ)¬≥ + (jXA/(Œ∑B))¬∑cos(œÑ)¬≤ + ((1-B)/B)¬∑cos(œÑ) + (jX(1-A))/(Œ∑B) = 0

text
–≥–¥–µ:
- `œÑ = œÄ/2 + 1.3j` ‚Äî –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —É–≥–æ–ª —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è
- `Œ∑ = 120œÄ` ‚Äî –≤–æ–ª–Ω–æ–≤–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

### 3. **–ú–æ—â–Ω–æ—Å—Ç—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã**
–ò–Ω—Ç–µ–≥—Ä–∞–ª –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–µ z:
P_surface = ‚à´ Re{E_z_sw ¬∑ H_y_sw*} / 2 dz

text
–≥–¥–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–ª—è:
E_z_sw = (jI‚ÇÄkŒ∑¬∑cos(œÑ)¬∑(1+B¬∑sin¬≤(œÑ))/D) ¬∑ exp(-jkz¬∑cos(œÑ)) ¬∑ exp(-jŒ©¬∑sin(œÑ))
H_y_sw = (-2œÄjC¬∑(Œ∑¬∑cos(œÑ)¬∑(1+B¬∑sin¬≤(œÑ)))/(sin(œÑ)¬∑D)) ¬∑ exp(-jkz¬∑cos(œÑ)) ¬∑ exp(-jŒ©¬∑sin(œÑ))
D = -2jXA¬∑cos(œÑ) - 3BŒ∑¬∑cos¬≤(œÑ) + Œ∑(1+B)

text
- `I‚ÇÄ` ‚Äî –∞–º–ø–ª–∏—Ç—É–¥–∞ —Ç–æ–∫–∞ (1.0 –ê)
- `k = 2œÄ/Œª` ‚Äî –≤–æ–ª–Ω–æ–≤–æ–µ —á–∏—Å–ª–æ
- `Œ© = kr` ‚Äî –±–µ–∑—Ä–∞–∑–º–µ—Ä–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
- `C = I‚ÇÄk/(2œÄŒ∑‚ÇÄ)` ‚Äî –Ω–æ—Ä–º–∏—Ä–æ–≤–æ—á–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞
- `Œ∑‚ÇÄ = 377` –û–º ‚Äî –∏–º–ø–µ–¥–∞–Ω—Å —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

### 4. **–ú–æ—â–Ω–æ—Å—Ç—å –æ–±—ä—ë–º–Ω–æ–π –≤–æ–ª–Ω—ã**
–ò–Ω—Ç–µ–≥—Ä–∞–ª –ø–æ —É–≥–ª—É œÜ:
P_volume = ‚à´ Re{S_normal} dœÜ

text
–≥–¥–µ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è –≤–µ–∫—Ç–æ—Ä–∞ –ü–æ–π–Ω—Ç–∏–Ω–≥–∞:
S_normal = S_x¬∑sin(œÜ) + S_z¬∑cos(œÜ)
S_x = -0.5¬∑E_z¬∑H_y*
S_z = 0.5¬∑E_x¬∑H_y*

text
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–ª—è –¥–ª—è –æ–±—ä—ë–º–Ω–æ–π –≤–æ–ª–Ω—ã:
E_z = (-Œ∑‚ÇÄ/‚àöŒ©)¬∑A_amp¬∑sin(œÜ)¬∑exp(-jŒ©)
E_x = (A_amp_e/‚àöŒ©)¬∑exp(-jŒ©)
H_y = (A_amp/‚àöŒ©)¬∑exp(-jŒ©)

text
—Å –∞–º–ø–ª–∏—Ç—É–¥–∞–º–∏:
A_amp = -C¬∑‚àö(2œÄ)/exp(-jœÄ/4)¬∑cos(œÜ)/((Z_s/Œ∑‚ÇÄ)+cos(œÜ))
A_amp_e = C¬∑‚àö(2œÄ)/exp(-jœÄ/4)¬∑(cos(œÜ)¬∑Z_s)/((Z_s/Œ∑‚ÇÄ)+cos(œÜ))

text

### 5. **–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**
F = log‚ÇÅ‚ÇÄ(P_surface/P_volume) - surface_penalty - ratio_penalty

text
–≥–¥–µ:
- `surface_penalty` ‚Äî —à—Ç—Ä–∞—Ñ –∑–∞ –º–∞–ª—É—é –º–æ—â–Ω–æ—Å—Ç—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–π –≤–æ–ª–Ω—ã
- `ratio_penalty` ‚Äî —à—Ç—Ä–∞—Ñ –∑–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–µ–Ω—å—à–µ 1

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Å–º. –Ω–∏–∂–µ).
2. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª `optim_v3.py` –≤ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∫–æ–º–∞–Ω–¥–æ–π:
   ```bash
   python optim_v3.py
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –±—É–¥—É—Ç –≤—ã–≤–µ–¥–µ–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª—å –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª results.txt.

–í–æ–∑–º–æ–∂–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã f –∏–ª–∏ –∞–º–ø–ª–∏—Ç—É–¥—ã —Ç–æ–∫–∞ I‚ÇÄ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ñ—É–Ω–∫—Ü–∏–∏ compute_powers().

–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–∏—Å–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∏–∑–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é bounds –≤ —Ñ—É–Ω–∫—Ü–∏–∏ two_stage_optimization().

üì¶ –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
Python 3.7+

NumPy

SciPy

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é pip:

bash
pip install numpy scipy
